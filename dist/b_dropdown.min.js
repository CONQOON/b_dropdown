/*! b_dropdown - v2.1.1 - 2018-08-14
* Copyright (c) 2018 Benjamin Gr√∂ner @ b:dreizehn Licensed MIT */

(function(){var s=function(t,e){return function(){return t.apply(e,arguments)}};define("b_dropdown",["jquery"],function(c){var t,n;return t=function(){function o(t,e){var i;if(this.toggleMock=s(this.toggleMock,this),this.selectOptionByValue=s(this.selectOptionByValue,this),this.select=s(this.select,this),this.resetSelection=s(this.resetSelection,this),this.openMock=s(this.openMock,this),this.closeMock=s(this.closeMock,this),this._handleWindowClick=s(this._handleWindowClick,this),this._handleToggleBtnClick=s(this._handleToggleBtnClick,this),this._handleChange=s(this._handleChange,this),this._handleMockOptionSelection=s(this._handleMockOptionSelection,this),this.$selectEl=c(t),this.$realOptions=this.$selectEl.children("option"),this.$selectEl.data("jsdropdown",this),this.opts=c.extend({},this.defaultOpts,e||{}),"SELECT"!==this.$selectEl.prop("tagName"))throw"The provided HTML element is no <select> element";i=this._getRenderDataFromSelectStructure(this.$selectEl),this.opts.selectedOption||null==i.selectedOption||(this.opts.selectedOption=i.selectedOption),this.$mockEl=c('<div class="bJS_dropdown b_dropdown"></div>'),this.$selectEl.before(this.$mockEl),this.$selectEl.addClass("b_dropdown-select"),this._renderMockHTMLFromData(this.$mockEl,i),this.$mockToggleHeader=this.$mockEl.find(".bJS_dropdown-toggle"),this.$mockMenu=this.$mockEl.find("ul"),this.$mockOptions=this.$mockMenu.children("li"),this.data={isMockOpen:!1,isDisabled:!1,ddOptions:this._initDropdownOptions()},this.changeHandlers=[],this.opts.staticHeader&&this.$mockToggleHeader.html("<span>"+this.opts.staticHeader+"</span>"),null!=this.opts.selectedOption&&0<=this.opts.selectedOption?this.select(this.opts.selectedOption,!0):this.select(0,!0),!1===this.opts.disabled?this.enable():(this.opts.disabled||this.$selectEl.prop("disabled"))&&this.disable(),this._bindEvents()}return o.prototype.defaultOpts={disabled:void 0,firstOptionIsPlaceholder:!1,hideOriginalSelect:!0},o.createDropdownFromJSON=function(t,e,i){return new o(this._renderSelectFromJSON(t,e),i)},o._renderSelectFromJSON=function(t,e){var i,o,n,s,l,r;for(o=c("<select></select>"),t.append(o),e.name&&o.attr("name",e.name),s=0,l=(r=e.options).length;s<l;s++)n=r[s],i=c("<option></option>"),o.append(i),n.value&&i.val(n.value),n.disabled&&i.prop("disabled",!0),n.label&&i.text(n.label);return o},o.prototype._renderMockHTMLFromData=function(t,e){var i,o,n,s,l,r,a,d,h,p;for(e.selectId&&t.data("for",e.selectId),t.append(c('<button type="button" class="bJS_dropdown-toggle b_dropdown-toggle"></button>')),o=c('<div class="b_dropdown-menuWrap"></div>'),t.append(o),i=c("<ul></ul>"),o.append(i),s=d=0,h=(p=e.options).length;d<h;s=++d)"string"==typeof(r=p[s])?a=l=r:(a=r.value,l=r.label||a),n=c('<li data-value="'+a+'"></li>'),i.append(n),n.text(l),r.disabled&&n.addClass("b_dropdown-disabled"),0===s&&this.opts.firstOptionIsPlaceholder&&n.addClass("b_dropdown-placeholder");return t},o.prototype._getRenderDataFromSelectStructure=function(t){var o;return o={options:[]},t.attr("id")&&(o.selectId=o),t.children("option").each(function(t){var e,i;return i={},e=c(this),i.label=e.text()||"",i.value=e.val()||i.label,i.disabled=e.prop("disabled"),i.selected=e.prop("selected"),i.selected&&(o.selectedOption=t),o.options.push(i)}),o},o.prototype._initDropdownOptions=function(){var t,e;return t=[],(e=this).$realOptions.each(function(){return t.push(new n(e,this))}),t},o.prototype._bindEvents=function(){return this.$mockToggleHeader.on("click",this._handleToggleBtnClick),this.$mockOptions.on("click",this._handleMockOptionSelection),this.$selectEl.on("change",this._handleChange),c(window).on("click",this._handleWindowClick),this},o.prototype._handleMockOptionSelection=function(t){this.select(this.$mockOptions.index(c(t.currentTarget))),this.closeMock()},o.prototype._handleChange=function(){var t;(t=this._updateSelect(this.$realOptions.filter(":selected"),!1,!0,!1,!0))&&!t.isDisabled()&&this.closeMock()},o.prototype._handleToggleBtnClick=function(t){t.preventDefault(),this.toggleMock()},o.prototype._handleWindowClick=function(t){this.isDisabled()||!this.isMockOpen()||c.contains(this.$mockEl.get(0),t.target)||this.closeMock()},o.prototype._unbindEvents=function(){return this.$mockToggleHeader.off("click",this._handleToggleBtnClick),this.$mockOptions.off("click",this._handleMockOptionSelection),this.$selectEl.off("change",this._handleChange),c(window).off("click",this._handleWindowClick),this.removeChangeHandlers(),this},o.prototype._updateSelect=function(t,e,i,o){var n;return n=this.getOption(t),new Date,n&&!n.isDisabled()&&(this.data.selectedOption=n,e&&n.$realEl.prop("selected",!0),i&&this.$mockToggleHeader.text(n.getLabel()),o&&this.$selectEl.trigger("change")),n},o.prototype.closeMock=function(){return this.isDisabled()||(this.$mockEl.removeClass("b_dropdown-open"),this.data.isMockOpen=!1),this},o.prototype.destroy=function(){this.$selectEl.removeClass("b_dropdown-select"),this.$mockEl.remove(),this._unbindEvents()},o.prototype.disable=function(){return this.closeMock(),this.$selectEl.prop("disabled",!0),this.$mockEl.addClass("b_dropdown-disabled"),this.data.isDisabled=!0,this},o.prototype.disableOption=function(t){var e;return(e=this.getOption(t))&&e.disable(),e},o.prototype.enable=function(){return this.$selectEl.prop("disabled",!1),this.$mockEl.removeClass("b_dropdown-disabled"),this.data.isDisabled=!1,this},o.prototype.enableOption=function(t){var e;return(e=this.getOption(t))&&e.enable(),e},o.prototype.getLabelForOption=function(t){var e;if(e=this.getOption(t))return e.getLabel()},o.prototype.getOption=function(t){var e,i;if(t instanceof n)i=this.data.ddOptions.indexOf(t);else if(t instanceof c)e=t;else if(t instanceof HTMLElement)e=c(t);else{if("number"!=typeof t)throw"Provided argument is neither a html element nor a number";i=t}return e&&(i=this.$realOptions.index(e)),this.getOptionByIndex(i)},o.prototype.getOptionByIndex=function(t){return this.data.ddOptions.length>t?this.data.ddOptions[t]:void 0},o.prototype.getSelectedIndex=function(){var t;return(t=this.getSelectedOption())?t.getIndex():0},o.prototype.getSelectedLabel=function(){var t;return(t=this.getSelectedOption())?t.getLabel():""},o.prototype.getSelectedOption=function(){return this.data.selectedOption||this.getOptionByIndex(0)},o.prototype.getSelectedValue=function(){var t;return(t=this.getSelectedOption())?t.getValue():void 0},o.prototype.getValueOfOption=function(t){var e;if(e=this.getOption(t))return e.getValue()},o.prototype.isDisabled=function(){return this.data.isDisabled},o.prototype.isMockOpen=function(){return this.data.isMockOpen||!1},o.prototype.offChange=function(t){var e;if(e=this.changeHandlers.indexOf(t),this.$selectEl.off("change",t),0<=e)return this.changeHandlers.splice(e,1),t},o.prototype.onChange=function(t){return this.changeHandlers.push(t),this.$selectEl.on("change",t),t},o.prototype.openMock=function(){return this.isDisabled()||(this.$mockEl.addClass("b_dropdown-open"),this.data.isMockOpen=!0),this},o.prototype.removeChangeHandlers=function(){var t,e,i,o,n;for(i=0,o=(n=this.changeHandlers).length;i<o;i++)t=n[i],this.offChange(t);return e=this.changeHandlers,this.changeHandlers=[],e},o.prototype.resetSelection=function(){return this.select(0)},o.prototype.select=function(t){return this._updateSelect(t,!0,!0,!0,!0)},o.prototype.selectOptionByValue=function(t){var e,i,o,n;for(i=0,o=(n=this.data.ddOptions).length;i<o;i++)if((e=n[i]).getValue()==t)return this.select(e)},o.prototype.setLabelForOption=function(t,e){var i;if(i=this.getOption(t))return i.setLabel(e)},o.prototype.setValueForOption=function(t,e){var i;if(i=this.getOption(t))return i.setValue(e)},o.prototype.toggleMock=function(){return this.isMockOpen()?this.closeMock():this.openMock(),this},o}(),n=function(){function i(t,e){if(this.dropdown=t,e instanceof i)this.$realEl=e.$realEl;else if(e instanceof c)this.$realEl=e.eq(0);else if(e instanceof HTMLElement)this.$realEl=c(e);else{if("number"!=typeof e)throw"Provided argument is neither a html element nor a number";this.index=e,this.$realEl=this.dropdown.$realOptions.eq(e)}null==this.index&&(this.index=this.dropdown.$realOptions.index(this.$realEl)),this.$mockEl=this.dropdown.$mockOptions.eq(this.index),this.isDisabled(),this.getLabel(),this.getValue()}return i.prototype.disable=function(){return this.disabled=!0,this.$realEl.prop("disabled",!0),this.$mockEl.addClass("b_dropdown-disabled"),this},i.prototype.enable=function(){return this.disabled=!1,this.$realEl.prop("disabled",!1),this.$mockEl.removeClass("b_dropdown-disabled"),this},i.prototype.get$RealEl=function(){return this.$realEl},i.prototype.get$MockEl=function(){return this.$mockEl},i.prototype.getIndex=function(t){return(t||null==this.index)&&(this.index=this.dropdown.$realOptions.index(this.$realEl)),this.index},i.prototype.getLabel=function(t){return(t||null==this.label)&&(this.label=this.$realEl.text()),this.label},i.prototype.getValue=function(t){return(t||null==this.value)&&(this.value=this.$realEl.val()||""),this.value},i.prototype.setLabel=function(t){return this.label=t,this.$realEl.text(t),this.$mockEl.text(t),this.isSelected()&&this.dropdown.$mockToggleHeader.text(t),t},i.prototype.setValue=function(t){return this.value=t,this.$realEl.val(t),t},i.prototype.isDisabled=function(t){return(t||null==this.disabled)&&(this.disabled=this.$realEl.prop("disabled")),this.disabled},i.prototype.isSelected=function(){return this.$realEl.prop("selected")},i}(),t})}).call(this);