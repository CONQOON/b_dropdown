/*! b_dropdown - v0.1.0 - 2015-03-03
* Copyright (c) 2015 Benjamin Gr√∂ner @ b:dreizehn Licensed MIT */
(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("b_dropdown",["jquery"],function(b){var c,d;return c=function(){function c(c,d){this.toggle=a(this.toggle,this),this.selectOption=a(this.selectOption,this),this.open=a(this.open,this),this.close=a(this.close,this),this._handleWindowClick=a(this._handleWindowClick,this),this._handleOptionSelection=a(this._handleOptionSelection,this),this.opts=b.extend({},this.defaultOpts,d||{}),this.$el=b(c),this.$toggleHeader=this.$el.find(".b_dropdown-toggle"),this.$menu=this.$el.find("ul"),this.$options=this.$menu.children("li"),this.$hiddenInput=this.$el.find("input[type=hidden]"),this.selectionHandlers=[],this.data={isOpen:!1,isDisabled:!1,ddOptions:this._initDropdownOptions()},this.opts.staticHeaderText?this.$toggleHeader.html("<span>"+this.opts.staticHeaderText+"</span>"):this.opts.placeholderHeaderText&&this.$toggleHeader.html("<span>"+this.opts.placeholderHeaderText+"</span>"),this.close(),this.bindEvents()}return c.prototype.defaultOpts={closeOnSelect:!0},c.prototype._initDropdownOptions=function(){var a,b;return b=this,a=[],this.$options.each(function(){return a.push(new d(b,this))}),a},c.prototype.bindEvents=function(){return this.$toggleHeader.on("click",this.toggle),this.$options.on("click",this._handleOptionSelection),b(window).on("click",this._handleWindowClick)},c.prototype.unbindEvents=function(){return this.$toggleHeader.off("click",this.toggle),b(window).off("click",this._handleWindowClick)},c.prototype._handleOptionSelection=function(a){var c;return!this.isDisabled()&&(c=this.$options.index(b(a.currentTarget)),this.selectOption(c),this.opts.closeOnSelect)?this.close():void 0},c.prototype._handleWindowClick=function(a){return this.isDisabled()||!this.isOpen()||b.contains(this.$el.get(0),a.target)?void 0:this.close()},c.prototype.onSelectOption=function(a){return this.selectionHandlers.push(a)},c.prototype.offSelectOption=function(a){var b;return b=this.selectionHandlers.indexOf(a),b>=0?this.selectionHandlers.splice(b,1):void 0},c.prototype.removeAllHandlers=function(){return this.selectionHandlers=[]},c.prototype.close=function(){return this.isDisabled()?void 0:(this.$menu.hide(),this.data.isOpen=!1)},c.prototype.disable=function(){return this.close(),this.$el.addClass("b_dropdown-disabled"),this.$hiddenInput.prop("disabled",!0),this.data.isDisabled=!0},c.prototype.enable=function(){return this.$el.removeClass("b_dropdown-disabled"),this.$hiddenInput.prop("disabled",!1),this.data.isDisabled=!1},c.prototype.getOption=function(a){var c,e;if(a instanceof d)e=this.data.ddOptions.indexOf(a);else if(a instanceof b)c=a;else if(a instanceof HTMLElement)c=b(a);else{if("number"!=typeof a)throw"Provided argument is neither a html element nor a number";e=a}return c&&(e=this.$options.index(c)),this.getOptionByIndex(e)},c.prototype.getOptionByIndex=function(a){return this.data.ddOptions.length>a?this.data.ddOptions[a]:null},c.prototype.getSelectedIndex=function(){var a;return a=this.getSelectedOption(),a?a.getIndex():-1},c.prototype.getSelectedLabel=function(){var a;return a=this.getSelectedOption(),a?a.getLabel():null},c.prototype.getSelectedOption=function(){return this.data.selectedOption||null},c.prototype.getSelectedValue=function(){var a;return a=this.getSelectedOption(),a?a.getValue():null},c.prototype.isDisabled=function(){return this.data.isDisabled},c.prototype.navigateToLink=function(a){return location.href=a},c.prototype.open=function(){return this.isDisabled()?void 0:(this.$menu.show(),this.data.isOpen=!0)},c.prototype.selectOption=function(a,b){var c,d,e,f,g,h,i;if(c=this.getOption(a),c&&(e=new Date,this.data.selectedOption=c,this.opts.staticHeaderText||(this.$toggleHeader.empty(),this.$toggleHeader.html(c.getLabel())),this.$hiddenInput.val(c.getValue()),!b)){for(h=this.selectionHandlers,i=[],f=0,g=h.length;g>f;f++)d=h[f],i.push(function(a){return function(b){return b.call(a,{dropdown:a,option:c,timestamp:e})}}(this)(d));return i}},c.prototype.toggle=function(){return this.isOpen()?this.close():this.open()},c.prototype.isOpen=function(){return this.data.isOpen||!1},c.prototype.destroy=function(){return this.enable(),this.unbindEvents()},c}(),d=function(){function a(c,d){if(this.dropdown=c,d instanceof a)this.$el=d.$el;else if(d instanceof b)this.$el=d.eq(0);else if(d instanceof HTMLElement)this.$el=b(d);else{if("number"!=typeof d)throw"Provided argument is neither a html element nor a number";this.index=d,this.$el=this.options.eq(d)}this.isLink=this.$el.find("a").length?!0:!1}return a.prototype.get$El=function(){return this.$el},a.prototype.getIndex=function(a){return(a||null==this.index)&&(this.index=this.dropdown.$options.index(this.$el)),this.index},a.prototype.getLabel=function(a){return(a||null==this.label)&&(this.label=this.$el.text()),this.label},a.prototype.getValue=function(a){var b;return(a||null==this.value)&&(b=this.isLink?this.$el.attr("href"):this.$el.data("value"),null==b&&(b=this.getLabel(a)),this.value=b),this.value},a.prototype.isLink=function(){return this.isLink},a}(),c})}).call(this);